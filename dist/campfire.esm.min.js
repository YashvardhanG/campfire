var m=r=>{var e;let s=r?r.match(/([0-9a-zA-Z\-]*)?(#[0-9a-zA-Z\-]*)?((.[0-9a-zA-Z\-]+)*)/):void 0,t=s?(e=s.slice(1,4))===null||e===void 0?void 0:e.map(i=>i?i.trim():void 0):Array(3).fill(void 0);return t&&t[1]&&(t[1]=t[1].replace(/#*/g,"")),s?{tag:t[0]||void 0,id:t[1]||void 0,classes:t[2]?t[2].split(".").filter(i=>i.trim()):void 0}:{}},E=(r,e={})=>{let{innerHTML:s,i:t,misc:i,m:l,style:u,s:p,on:h,attrs:c,a:_}=e,{tag:o,id:b,classes:f}=m(r);o||(o="div");let n=document.createElement(o);if(b&&(n.id=b),f&&f.forEach(a=>n.classList.add(a)),s=s||t,i=i||l,u=u||p,c=c||_,s&&(n.innerHTML=s),i&&Object.assign(n,i),u&&Object.assign(n.style,u),h)for(let a in h)n.addEventListener(a,h[a]);if(c)for(let a in c)n.setAttribute(a,c[a]);return n},d=class{constructor(e){this.value=null,this._subscribers={},this._subscriberCounts={},this._dead=!1,this.value=e}on(e,s,t=!1){return this._subscriberCounts[e]=this._subscriberCounts[e]||0,this._subscribers[e]=this._subscribers[e]||{},this._subscribers[e][this._subscriberCounts[e]]=s,t&&s(this.value),this._subscriberCounts[e]++}unsubscribe(e,s){delete this._subscribers[e][s]}update(e){this._dead||(this.value=e,this._sendEvent("update",e))}refresh(){this._sendEvent("refresh",this.value)}_sendEvent(e,s){if(!this._dead){this._subscribers[e]=this._subscribers[e]||{};for(let t in Object.keys(this._subscribers[e]))this._subscribers[e][t](s)}}dispose(){this._dead=!0}},g=class extends d{constructor(e){super(e)}clear(){this.update([])}push(e){this.value.push(e),this._sendEvent("push",{value:e,idx:this.value.length-1})}remove(e){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");this.value.splice(e,1),this._sendEvent("remove",{value:this.value[e],idx:e})}get(e){if(e<0||e>this.value.length)throw new RangeError("Invalid index.");return this.value instanceof Array&&this.value[e]}setAt(e,s){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");this.value[e]=s,this._sendEvent("mutation",{value:s,idx:e})}get length(){return this.value.length}},v=(r,e={})=>Object.entries(e).reduce((s,[t,i])=>{let l=new RegExp(`(?<!\\\\){{\\s*${t}\\s*}}`,"g"),u=new RegExp(`\\\\({{\\s*${t}\\s*}})`,"g");return s.replace(l,i||"").replace(u,"$1")},r),w=r=>e=>v(r,e),A=r=>r?r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):"",R=r=>{if(!r)return"";let e=/(?<!\\)&(?:amp|lt|gt|quot|#(0+)?(?:39|96));/g,s=/\\(&(?:amp|lt|gt|quot|#(0+)?(?:39|96));)/g,t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return r.replace(e,i=>t[i]||"'").replace(s,"$1")},x={Store:d,ListStore:g,nu:E,mustache:v,template:w,escape:A,unescape:R};export{g as ListStore,d as Store,x as default,A as escape,v as mustache,E as nu,w as template,R as unescape};
